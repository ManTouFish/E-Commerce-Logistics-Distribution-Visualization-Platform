# 配送范围功能测试说明

## 功能概述
实现了点击"圈选配送范围"按钮后，将商家的"配送范围"列值更新为视口中展示的地图范围的功能。

## 实现步骤

### 1. 创建商家服务 (src/services/shopService.ts)
- 定义了Shop接口和商家服务函数
- 实现了获取商家信息、更新配送范围等API调用

### 2. 修改TrajectoryMapMerchant组件 (src/components/map/trajectoryMapMerchant.tsx)
- 添加了配送范围相关的状态管理
- 实现了地图多边形绘制功能
- 添加了保存配送范围到数据库的功能
- 添加了自定义事件监听器，响应"圈选配送范围"按钮点击

### 3. 修改商家页面 (src/pages/merchant/index.tsx)
- 添加了"圈选配送范围"按钮
- 实现了按钮点击事件处理
- 添加了配送范围更新后的回调处理

## 使用方法
1. 在商家页面点击"圈选配送范围"按钮
2. 在地图上点击三个或更多点来绘制配送范围多边形
3. 系统会自动将绘制的多边形保存为商家的配送范围

## 技术实现
- 使用高德地图API进行地图操作和多边形绘制
- 使用PostGIS存储和查询地理空间数据
- 使用React Hooks管理组件状态
- 使用TypeScript确保类型安全

## 注意事项
- 需要确保用户已登录并有商家权限
- 配送范围数据使用WGS84坐标系
- 地图多边形至少需要3个点才能形成有效区域